<?xml version="1.0" encoding="utf-8"?>
<!--
<auto-generated>
    This code was generated by WixSharp.
    Changes to this file will be lost if the code is regenerated.
</auto-generated>
-->
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
  <Product Id="96f03431-cd66-4a3e-958d-e71ff7662bd4" Name="Quintity.TestFramework.TestListenersService" Language="1033" Codepage="Windows-1252" Version="1.0.0.0" UpgradeCode="96f03431-cd66-4a3e-958d-e71fe7662bd3" Manufacturer="Quintity, LLC">
    <Package InstallerVersion="200" Compressed="yes" SummaryCodepage="Windows-1252" Languages="1033" />
    <Media Id="1" Cabinet="_...Framework.TestListenersService.cab" EmbedCab="yes" />

    <Directory Id="TARGETDIR" Name="SourceDir">
      <Directory Id="INSTALLDIR" Name="ABSOLUTEPATH">

        <Component Id="Component.Quintity.TestFramework.TestListenersService.Host.exe_1280457659" Guid="96f03431-cd66-4a3e-958d-e71fa448ec3d">
          <File Id="Quintity.TestFramework.TestListenersService.Host.exe_1280457659" Source="..\Quintity.TestFramework.TestListenersService.Host\bin\Debug\Quintity.TestFramework.TestListenersService.Host.exe" />

          <ServiceInstall Id="Quintity_TestListenersService" Name="Quintity TestListenersService" DisplayName="Quintity TestListenersService" Description="Quintity runtime listener test management service." Type="ownProcess" Start="auto" ErrorControl="normal" Arguments="/S">
            <ServiceConfig OnInstall="yes" OnReinstall="no" OnUninstall="no" />
            <ServiceConfig FirstFailureActionType="none" SecondFailureActionType="none" ThirdFailureActionType="none" xmlns="http://schemas.microsoft.com/wix/UtilExtension" />
          </ServiceInstall>

          <ServiceControl Id="StopQuintity_TestListenersService" Name="Quintity TestListenersService" Stop="both" Wait="yes" />
          <ServiceControl Id="StartQuintity_TestListenersService" Name="Quintity TestListenersService" Start="install" Wait="no" />
          <ServiceControl Id="RemoveQuintity_TestListenersService" Name="Quintity TestListenersService" Remove="uninstall" Wait="yes" />
        </Component>

        <Component Id="Component.Uninstall_TestListenersService" Guid="96f03431-cd66-4a3e-958d-e71f72f918b6">
          <Shortcut Id="INSTALLDIR.Uninstall_TestListenersService" WorkingDirectory="System64Folder" Target="[System64Folder]msiexec.exe" Arguments="/x [ProductCode]" Name="Uninstall TestListenersService.lnk" />

          <CreateFolder />
          <RemoveFolder Id="INSTALLDIR" On="uninstall" />

          <RegistryKey Root="HKCU" Key="Software\WixSharp\Used">
            <RegistryValue Value="0" Type="string" KeyPath="yes" />
          </RegistryKey>
        </Component>

        <Directory Id="DesktopFolder" Name="DesktopFolder">

          <Component Id="Component.Quintity_TestLIsteners_Service" Guid="96f03431-cd66-4a3e-958d-e71fbb5c44c1">
            <Shortcut Id="DesktopFolder.Quintity_TestLIsteners_Service" WorkingDirectory="INSTALLDIR" Target="[INSTALLDIR]Quintity.TestFramework.TestListenersService.Host.exe" Name="Quintity TestLIsteners Service.lnk" />

            <CreateFolder />

            <RegistryKey Root="HKCU" Key="Software\WixSharp\Used">
              <RegistryValue Value="0" Type="string" KeyPath="yes" />
            </RegistryKey>
          </Component>

        </Directory>

        <Directory Id="INSTALLDIR.Logs" Name="Logs">

          <Component Id="Component.INSTALLDIR.Logs.EmptyDirectory" Guid="96f03431-cd66-4a3e-958d-e71ff484f730" KeyPath="yes">
            <CreateFolder />
            <RemoveFolder Id="INSTALLDIR.Logs" On="uninstall" />
          </Component>

        </Directory>
      </Directory>

      <Component Id="TARGETDIR" Guid="96f03431-cd66-4a3e-958d-e71f5a369b46" KeyPath="yes">
        <CreateFolder />
        <RemoveFolder Id="TARGETDIR" On="uninstall" />
      </Component>

    </Directory>

    <UI />

    <CustomAction Id="Set_ARPINSTALLLOCATION" Property="ARPINSTALLLOCATION" Value="[INSTALLDIR]" Return="check" Execute="immediate" />
    <CustomAction Id="Set_DirAbsolutePath" Property="INSTALLDIR" Value="C:\Quintity.TestFramework.TestListenersService" />

    <Property Id="INSTALLDIR_ABSOLUTEPATH" Value="C:\Quintity.TestFramework.TestListenersService" />

    <Feature Id="Complete" Title="Complete" Absent="allow" Level="1">
      <ComponentRef Id="Component.Quintity.TestFramework.TestListenersService.Host.exe_1280457659" />
      <ComponentRef Id="Component.Uninstall_TestListenersService" />
      <ComponentRef Id="Component.Quintity_TestLIsteners_Service" />
      <ComponentRef Id="Component.INSTALLDIR.Logs.EmptyDirectory" />
      <ComponentRef Id="TARGETDIR" />
    </Feature>

    <InstallExecuteSequence>
      <Custom Action="Set_ARPINSTALLLOCATION" After="CostFinalize"> (NOT Installed) </Custom>
      <Custom Action="Set_DirAbsolutePath" Before="AppSearch">(NOT Installed) AND (UILevel &lt; 5) AND (INSTALLDIR = ABSOLUTEPATH)</Custom>
    </InstallExecuteSequence>

    <InstallUISequence>
      <Custom Action="Set_DirAbsolutePath" Before="AppSearch">(NOT Installed) AND (UILevel = 5) AND (INSTALLDIR = ABSOLUTEPATH)</Custom>
    </InstallUISequence>

  </Product>
</Wix>

